
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="baidu-site-verification" content="TcPgCnDcOJ">
    <link rel="apple-touch-icon" href="https://www.django.cn/static/images/icon-touch.png">
    <link rel="icon" sizes="192x192" href="https://www.django.cn/static/images/icon-touch.png">
    <link rel="shortcut icon" href="https://www.django.cn/static/images/favicon.ico">
    
    <title>centos和ubuntu下redis的安装与使用-Django社区,Django中文网,django教程,Django！</title>
    <meta name="keywords" content="centos安装redis,ubuntu下安装redis,linux下安装redis">
    <meta name="description" content="Redis 是一个开源（BSD许可）的，内存中的数据结构存储系统，它可以用作数据库、缓存和消息中间件。">

    <meta name="theme-color" content="#ffffff">
    <link href="static/css/fonts.css" rel="stylesheet">
    <link href="static/css/bootstrap.min.css" rel="stylesheet">
    <link href="static/css/toastr.min.css" rel="stylesheet">
    <link href="static/css/app.css" rel="stylesheet">
    <link href="static/css/font-awesome.min.css" rel="stylesheet">
     
    <script src="static/js/jquery.min.js"></script>
    <script src="static/js/bootstrap.min.js"></script>
    <script src="static/js/highlight.min.js"></script>
    <script src="static/js/toastr.min.js"></script>

   <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?9b0ccd50ff8935f331889174a8280dc2";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

</head>
<body>
<div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <div style='text-align: center;font-size: 20px'>确定删除?</div>
            </div>
            <div class="modal-footer">
                <form action="/comment/" method="POST" id='delete_comment' style='float: left'>
                    <input type="hidden" name="csrfmiddlewaretoken" value="Nj1DzHXvO2SnFKBqZ7XYLOF9RpHBsAhAfEnjpsA0nEo5BJVXriubaAUuK3Kz1Kmh">
                    <input type="hidden" name="tag">
                    <input type="hidden" name="aid">
                    <input type="hidden" name="id">
                    <input type="hidden" name="method" value='delete'>
                    <input type='button' class="btn btn-danger btn-ok" id='btn_delete_comment' value='删除'>
                </form>
                <!-- <a class="btn btn-danger btn-ok"><span>删除</span></a> -->
                <button type="button" class="btn btn-default" data-dismiss="modal"><span>取消</span></button>
            </div>
        </div>
    </div>
</div>


    <div class="page__wrapper page--landing">
   
    <header class="header--main animate-search">

    
    <div class="container-fluid">
        <nav class="nav--main">
            <div class="nav__logo">
                <a href="index.html">
                    <span>Django中文网</span>
                </a>
            </div>

            
                <ul class="nav__items nav__items--right">
                    <li class="nav__item">
                        <a href="search.html" class="search-trigger icon-magnifier"></a>
                    </li>
                    <li id="login" class="nav__item">
                        <a href="login.html">
                            登录
                        </a>
                    </li>
                    <li id="register" class="nav__item">
                        <a href="register.html">
                            <span class="btn btn-success">注册</span>
                        </a>
                    </li>
                </ul>

            

            <ul class="nav__items nav__items--left">
                <li class="nav__item nav__item--main">
                    <a href="article.html" class="articles ">
                        文章
                    </a>
                </li>
                 <li class="nav__item nav__item--main">
                    <a href="course.html" class="posts ">
                        教程
                    </a>
                </li>
                <li class="nav__item nav__item--main">
                    <a href="video.html" class="posts ">
                        视频
                    </a>
                </li>
                <li class="nav__item nav__item--main">
                     <a href="forum.html" class="posts ">
                        社区
                    </a>
                </li>
            </ul>


        </nav> <!-- .nav--main -->
    </div>


    <a href="#0" class="nav-trigger icon-menu"></a>

    <div id="search" class="main-search">
    <div class="container-fluid">
        <form id="search-form-top" class="form__search" action="/search/" method="GET">
        <input type="search" name="search" placeholder="Search..." value="" autocomplete="off" required="">

</form>

        <div class="search-suggestions">

        </div>
        <a href="#0" class="close text-replace">Close Form</a>
    </div>
</div> <!-- .main-search -->
</header>

<div class="cover-layer"></div> <!-- cover main content when search form is open -->


    
    <div class="cover-layer"></div>
    <!-- cover main content when search form is open -->
    <main class="main-content" style=" margin-top:40px;">
        <div class="content-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-9 article-content">
                        <article class="article--big">
                            <!--<a href="https://jq.qq.com/?_wv=1027&k=0kNpqlZH" target="_blank"><img src="/static/img/web2.jpg"> </a>-->
                            
                                <div class="article__image" style="background-image: url(static/image/redis_ft0hWBs.jpg)"></div>
                            
                            <div class="article__content">
                                <h1 class="article__title">
                                    centos和ubuntu下redis的安装与使用

                                </h1>
                                <div class="article__header">
                                    <div class="article__date">
                                        <time>2019年01月01日</time>
                                    </div>
                                    <div class="article__date">点击次数：10018 </div>
                                </div>
                                <div class="article__body">
                                    
                                    <p>Redis 是一个开源（BSD许可）的，内存中的数据结构存储系统，它可以用作数据库、缓存和消息中间件。 Redis支持五种数据类型：string（字符串），hash（哈希），list（列表），set（集合）及zset(sorted set：有序集合)。Django中经常用它来提升数据查询性能。下面与大家一起学习如何在Linux下安装与使用redis。</p><p>1、<a href="#anzhuang" target="_self">redis安装</a></p><p>2、<a href="#pz" target="_self">redis配置常用的配置方法</a></p><p>3、<a href="#cz" target="_self">redis常用操作</a></p><p>4、<a href="#py" target="_self">Python操作redis</a></p><p>5、<a href="#dj" target="_self">Django中使用redis</a><br></p><hr><p><span style="font-size: 18px;"><strong id="anzhuang">一、redis安装</strong></span></p><p><strong>Centos7下安装redis</strong></p><p>1、通过yum源安装redis<br></p><pre class="brush:bash;toolbar:false">yum&nbsp;install&nbsp;redis</pre><p>2、如果没有redis yum源则下载fedora的epel仓库，然后再安装redis<br></p><pre class="brush:bash;toolbar:false">yum&nbsp;install&nbsp;epel-release&nbsp;&nbsp;#下载fedora的epel仓库
yum&nbsp;install&nbsp;redis&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#安装redis</pre><p>3、安装成功之后，通过下面命令启动redis</p><pre class="brush:bash;toolbar:false">#&nbsp;启动redis
service&nbsp;redis&nbsp;start
#&nbsp;停止redis
service&nbsp;redis&nbsp;stop
#&nbsp;查看redis运行状态
service&nbsp;redis&nbsp;status
#&nbsp;查看redis进程
ps&nbsp;-ef&nbsp;|&nbsp;grep&nbsp;redis</pre><p>4、让redis开机自行启动</p><pre class="brush:bash;toolbar:false">chkconfig&nbsp;redis&nbsp;on</pre><p><strong>Ubuntu下安装redis</strong></p><p>1、安装与卸载命令</p><pre class="brush:bash;toolbar:false">sudo&nbsp;apt-get&nbsp;install&nbsp;redis-server&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#安装
sudo&nbsp;apt-get&nbsp;purge&nbsp;--auto-remove&nbsp;redis-server&nbsp;&nbsp;#卸载</pre><p>2、启动redis</p><pre class="brush:bash;toolbar:false">ps&nbsp;aux|grep&nbsp;redis&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#查看redis状态
sudo&nbsp;service&nbsp;redis-server&nbsp;start&nbsp;&nbsp;&nbsp;&nbsp;#启动redis
sudo&nbsp;service&nbsp;redis-server&nbsp;stop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#停止redis</pre><p><br></p><hr><p><span style="font-size: 18px;"><strong id="pz">二、redis配置常用的配置方法</strong></span></p><p>redis默认配置文件为/etc/redis.conf，我们通常按需求修改里面的参数对其进行设置。</p><p>1、指定Redis监听端口，默认端口为6379</p><pre class="brush:bash;toolbar:false">port&nbsp;6379</pre><p>2、绑定主机IP地址</p><pre class="brush:bash;toolbar:false">bind&nbsp;127.0.0.1</pre><p>3、设置数据库的数量，默认数据库为0</p><pre class="brush:bash;toolbar:false">databases&nbsp;16</pre><p>4、指定在多长时间内，有多少次更新操作，就将数据同步到数据文件，可以多个条件配合</p><p><span style="color: rgb(192, 0, 0);">save &lt;seconds&gt; &lt;changes&gt;</span><br>Redis默认配置文件中提供了三个条件：</p><pre class="brush:bash;toolbar:false">save&nbsp;900&nbsp;1
save&nbsp;300&nbsp;10
save&nbsp;60&nbsp;10000</pre><p>5、指定本地数据库文件名，默认值为dump.rdb</p><pre class="brush:bash;toolbar:false">dbfilename&nbsp;dump.rdb</pre><p>6、指定本地数据库存放目录</p><pre class="brush:bash;toolbar:false">dir&nbsp;/var/lib/redis&nbsp;&nbsp;#默认存放目录</pre><p>7、指定是否激活重置哈希，默认为开启</p><pre class="brush:bash;toolbar:false">activerehashing&nbsp;yes</pre><p>8、设置Redis连接密码，如果配置了连接密码，客户端在连接Redis时需要通过AUTH &lt;password&gt;命令提供密码，默认关闭</p><pre class="brush:bash;toolbar:false">&nbsp;requirepass&nbsp;foobared&nbsp;&nbsp;&nbsp;#foobared&nbsp;为密码</pre><p>上面是学用的，更多的配置，请直接查看配置文件的注释或者查看官方文档。</p><hr><p><span style="font-size: 18px;"><strong id="cz">三、redis常用操作</strong></span></p><p><strong>1、连接redis</strong></p><pre class="brush:bash;toolbar:false">redis-cli&nbsp;-h&nbsp;[ip]&nbsp;-p&nbsp;[端口]
#例
redis-cli&nbsp;-h&nbsp;127.0.0.1&nbsp;-p&nbsp;6379</pre><p>如果设置密码了的话，就输入密码：</p><pre class="brush:bash;toolbar:false">auth&nbsp;445813&nbsp;&nbsp;#445813为密码，输入密码前要密码前面加&nbsp;auth和空格</pre><p><img src="static/picture/20190101174547_20190101174718_196.jpg" title="" alt="20190101174547.jpg"></p><p><strong>2、简单的redis 键(key)操作<br></strong></p><pre class="brush:bash;toolbar:false">#添加
set&nbsp;key&nbsp;value
#例
set&nbsp;webname&nbsp;django.cn
set&nbsp;usrname&nbsp;&quot;My&nbsp;namne&nbsp;is&nbsp;XXX&quot;&nbsp;#中间有空格的要用引号
#通过KEY查询
127.0.0.1:6379&gt;&nbsp;get&nbsp;webname
&quot;django.cn&quot;
#删除key
del&nbsp;webname

#设置过期时间(单位为秒)
expire&nbsp;key&nbsp;timeout
#也可以在设置值的时候，一同指定过期时间
set&nbsp;key&nbsp;value&nbsp;EX&nbsp;timeout
#例子
set&nbsp;name&nbsp;django.cn&nbsp;EX&nbsp;20&nbsp;&nbsp;#设置20秒过期

#查看过期时间
ttl&nbsp;key
#如
ttl&nbsp;name

#查看当前redis中所有Key
keys&nbsp;*</pre><p><img src="static/picture/3_20190101183600_646.jpg" title="" alt="3.jpg"></p><p>Redis支持五种数据类型：string（字符串），hash（哈希），list（列表），set（集合）及zset(sorted set：有序集合)。更多关于不同数据类型操作方法，请大家查看官方文档：<a href="https://redis.io/commands" target="_blank" title="https://redis.io/commands" textvalue="https://redis.io/commands">https://redis.io/commands</a> （英文），这里还有一个中文的，可以去看看。<a href="http://redisdoc.com/index.html" target="_blank" textvalue="http://redisdoc.com/index.html">http://redisdoc.com/index.html</a>&nbsp; &nbsp;</p><hr><p><span style="font-size: 18px;"><strong id="py">四、Python操作redis</strong></span><br></p><p>1、安装 python-redis</p><pre class="brush:bash;toolbar:false">pip&nbsp;install&nbsp;redis</pre><p>2、新建一个redis_demo.py文件。输入如下代码：</p><pre class="brush:bash;toolbar:false">#&nbsp;从redis包中导入Redis类
from&nbsp;redis&nbsp;import&nbsp;Redis
#&nbsp;初始化redis实例变量
myredis&nbsp;=&nbsp;Redis(host=&#39;192.168.1.100&#39;,port=6379)
#如果设置了密码则
myredis&nbsp;=&nbsp;Redis(host=&#39;192.168.1.100&#39;,port=6379,&nbsp;password=&#39;445813&#39;)</pre><p>3、对字符串的操作</p><pre class="brush:bash;toolbar:false">#添加一个值，并设置过期时间为60秒，如果不设置，则永远不会过期
myredis.set(&#39;webname&#39;,&#39;django.cn&#39;,ex=60)
#获取Key值
myredis.get(&#39;webname&#39;)
#&nbsp;删除一个值
myredis.delete(&#39;username&#39;)
#&nbsp;给某个值自增1
myredis.set(&#39;views&#39;,1)
myredis.incr(&#39;views&#39;)&nbsp;#&nbsp;这时候views变为2
#&nbsp;给某个值减少1
myredis.decr(&#39;views&#39;)&nbsp;#&nbsp;这时候views变为1</pre><p>以上便展示了 python-redis 的一些常用方法，如果想深入了解其他的方法，可以参考 pythonredis 的源代码（查看源代码 pycharm 快捷键提示：把鼠标光标放在 import Redis 的 Redis 上，然后按 ctrl+b 即可进入）。</p><hr><p><span style="font-size: 18px;"><strong id="dj">五、Django中使用redis</strong></span></p><p>1、Django想要使用redis，我们需要先安装django-redis</p><pre class="brush:bash;toolbar:false">pip3&nbsp;install&nbsp;django-redis</pre><p>2、settings.py里配置redia</p><pre class="brush:bash;toolbar:false">CACHES&nbsp;=&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&quot;default&quot;:&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;BACKEND&quot;:&nbsp;&quot;django_redis.cache.RedisCache&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;LOCATION&quot;:&nbsp;&quot;redis://127.0.0.1:6379&quot;,&nbsp;#服务器地址
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;OPTIONS&quot;:&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;CLIENT_CLASS&quot;:&nbsp;&quot;django_redis.client.DefaultClient&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;CONNECTION_POOL_KWARGS&quot;:&nbsp;{&quot;max_connections&quot;:&nbsp;100}#最大连接数
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&quot;PASSWORD&quot;:&nbsp;&quot;密码&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}　　</pre><p>3、常规redis使用方法</p><pre class="brush:bash;toolbar:false">import&nbsp;redis
from&nbsp;django.shortcuts&nbsp;import&nbsp;render,HttpResponse
from&nbsp;utils.redis_pool&nbsp;import&nbsp;POOL
&nbsp;
def&nbsp;index(request):
&nbsp;&nbsp;&nbsp;&nbsp;conn&nbsp;=&nbsp;redis.Redis(connection_pool=POOL)
&nbsp;&nbsp;&nbsp;&nbsp;conn.hset(&#39;kkk&#39;,&#39;age&#39;,18)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;HttpResponse(&#39;设置成功&#39;)
&nbsp;
def&nbsp;order(request):
&nbsp;&nbsp;&nbsp;&nbsp;conn&nbsp;=&nbsp;redis.Redis(connection_pool=POOL)
&nbsp;&nbsp;&nbsp;&nbsp;conn.hget(&#39;kkk&#39;,&#39;age&#39;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;HttpResponse(&#39;获取成功&#39;)</pre><p>4、设置多个redis链接(settings.py)</p><pre class="brush:bash;toolbar:false">CACHES&nbsp;=&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&quot;default&quot;:&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;BACKEND&quot;:&nbsp;&quot;django_redis.cache.RedisCache&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;LOCATION&quot;:&nbsp;&quot;redis://127.0.0.1:6379&quot;,&nbsp;#服务器地址
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;OPTIONS&quot;:&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;CLIENT_CLASS&quot;:&nbsp;&quot;django_redis.client.DefaultClient&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;CONNECTION_POOL_KWARGS&quot;:&nbsp;{&quot;max_connections&quot;:&nbsp;100}&nbsp;#最大连接数
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&quot;PASSWORD&quot;:&nbsp;&quot;密码&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&quot;back&quot;:&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;BACKEND&quot;:&nbsp;&quot;django_redis.cache.RedisCache&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;LOCATION&quot;:&nbsp;&quot;redis://127.0.0.1:6379&quot;,&nbsp;#服务器地址
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;OPTIONS&quot;:&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;CLIENT_CLASS&quot;:&nbsp;&quot;django_redis.client.DefaultClient&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;CONNECTION_POOL_KWARGS&quot;:&nbsp;{&quot;max_connections&quot;:&nbsp;100}&nbsp;#最大连接数
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&quot;PASSWORD&quot;:&nbsp;&quot;密码&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
}　</pre><p>获取数据：</p><pre class="brush:bash;toolbar:false">import&nbsp;redis
from&nbsp;django.shortcuts&nbsp;import&nbsp;render,HttpResponse
from&nbsp;django_redis&nbsp;import&nbsp;get_redis_connection
&nbsp;
def&nbsp;index(request):
&nbsp;&nbsp;&nbsp;&nbsp;conn&nbsp;=&nbsp;get_redis_connection(&quot;default&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;HttpResponse(&#39;设置成功&#39;)
def&nbsp;order(request):
&nbsp;&nbsp;&nbsp;&nbsp;conn&nbsp;=&nbsp;get_redis_connection(&quot;back&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;HttpResponse(&#39;获取成功&#39;)</pre><p>5、Django全站缓存</p><p>django中给整个网站都设置缓存，我们需要在中间件的第一行和最后一行进行如下设置：<br></p><pre class="brush:bash;toolbar:false">&nbsp;MIDDLEWARE&nbsp;=&nbsp;[&nbsp;
&nbsp;#&nbsp;站点缓存&nbsp;，&nbsp;注意必须在第一个位置&nbsp;
&nbsp;&#39;django.middleware.cache.UpdateCacheMiddleware&#39;,&nbsp;
&nbsp;...&nbsp;
&nbsp;#&nbsp;站点缓存,&nbsp;注意必须在最后一个位置&nbsp;
&nbsp;&#39;django.middleware.cache.FetchFromCacheMiddleware&#39;,
&nbsp;&nbsp;]</pre><p>使用中间件，经过一系列的认证等操作，如果内容在缓存中存在，则使用FetchFromCacheMiddleware获取内容并返回给用户，当返回给用户之前，判断缓存中是否已经存在，如果不存在则UpdateCacheMiddleware会将缓存保存至缓存，从而实现全站缓存。<br></p><p>示例：</p><pre class="brush:bash;toolbar:false">from&nbsp;django.shortcuts&nbsp;import&nbsp;render,HttpResponse
import&nbsp;time

def&nbsp;index(request):
&nbsp;&nbsp;&nbsp;&nbsp;ctime&nbsp;=&nbsp;str(time.time())
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;HttpResponse(ctime)
&nbsp;
def&nbsp;order(request):
&nbsp;&nbsp;&nbsp;&nbsp;ctime&nbsp;=&nbsp;str(time.time())
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;HttpResponse(ctime)　　</pre><p>6、单页面缓存或者单视图缓存</p><p>把之前的中间件去掉，我们在视图里加装饰器。需要留意的是，给视图添加缓存是有风险的，如果视图所展示的网页中有经常动态变动的信息，那么被添加缓存命不可取。缓存整个视图最实用的场景应该是这个视图所展示的网页的内容基本上不怎么变动，或者说在很长一段时间内不需要变动，这样使用缓存就非常有效。</p><pre class="brush:bash;toolbar:false">from&nbsp;django.shortcuts&nbsp;import&nbsp;render,HttpResponse
import&nbsp;time
from&nbsp;django.views.decorators.cache&nbsp;import&nbsp;cache_page
from&nbsp;rest_framework.throttling&nbsp;import&nbsp;SimpleRateThrottle
&nbsp;
@cache_page(60&nbsp;*&nbsp;15)
def&nbsp;index(request):
&nbsp;&nbsp;&nbsp;&nbsp;ctime&nbsp;=&nbsp;str(time.time())
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;HttpResponse(ctime)
&nbsp;
def&nbsp;order(request):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;render(request,&#39;order.html&#39;)</pre><p>7、URLconf中使用缓存</p><p>上面说了函数视图使用缓存，但是我们可能还有一种场景，那就是多个 URL 指向同一个函数视图，但是我只想缓存一部分的 URL，这时候就可以采用在 URLconf 中使用缓存，这样就指定了哪些 URL 需要缓存。<br>下面分别表示了函数视图和类视图的路由中使用缓存的方式，基本一致：</p><pre class="brush:bash;toolbar:false">from&nbsp;django.views.decorators.cache&nbsp;import&nbsp;cache&nbsp;_page
urlpatterns&nbsp;=&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;url(r&#39;^foo/([0-9]{1,2})/$&#39;,cache_page(60&nbsp;*&nbsp;15)(index)),
&nbsp;&nbsp;&nbsp;&nbsp;url(r&#39;^$&#39;,&nbsp;cache_page(60&nbsp;*&nbsp;30)(IndexView.as_view()),&nbsp;name=&#39;order&#39;),
&nbsp;&nbsp;&nbsp;&nbsp;]</pre><p>URLconf 使用缓存和视图函数使用缓存需要注意的地方是一样的，因为它们都是缓存整个页面，所有都需要考虑是否整个页面都应该缓存。</p><p>8、模板页面（局部页面）缓存</p><p>模板中使用缓存是比较推荐的一种缓存方式，因为使用这种方式可以充分的考虑缓存的颗粒度，细分颗粒度，可以保证只缓存那些适合使用缓存的 HTML 片段。</p><pre class="brush:bash;toolbar:false">{%&nbsp;load&nbsp;cache&nbsp;%}
&lt;!DOCTYPE&nbsp;HTML&gt;
&lt;html&gt;
&lt;head&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;charset=&quot;UTF-8&quot;&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;Myblog&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;h2&gt;测试redis&lt;/h2&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;p&gt;非缓存地段&lt;/p&gt;&lt;/div&gt;

&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;cache&nbsp;10&nbsp;aabbcc&nbsp;%}
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;p&gt;这里缓存&lt;/p&gt;&lt;/div&gt;
&nbsp;&nbsp;&nbsp;&nbsp;{%&nbsp;endcache&nbsp;%}
&nbsp;&nbsp;&nbsp;&nbsp;
&lt;/body&gt;</pre><p><img src="static/picture/4_20190101205341_378.jpg" title="" alt="4.jpg"></p><p>如上图，留意飘红的位置。很多地方是不需要从数据库查询数据的，访问频率高，所以可以进行缓存。</p><p><strong>9、做缓存之前，建议做一下测试（非必须）</strong></p><p>进入django的后台命令模式：<br></p><pre class="brush:bash;toolbar:false">python&nbsp;manage.py&nbsp;shell</pre><p>逐条输入如下命令测试：</p><pre class="brush:bash;toolbar:false">from&nbsp;django.core.cache&nbsp;import&nbsp;cache&nbsp;#引入缓存模块
cache.set(&#39;v&#39;,&nbsp;&#39;555&#39;,&nbsp;60*60)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#写入key为v，值为555的缓存，有效期30分钟
cache.has_key(&#39;v&#39;)&nbsp;#判断key为v是否存在
cache.get(&#39;v&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#获取key为v的缓存</pre><hr><p><span style="font-size: 18px;"><strong>最后：</strong></span></p><p>建议一般情况下不要进行整个页面的缓存，要有选择性的，<strong>缓存的使用原则：</strong><br>1、纯静态页面<br>2、读取了数据库信息，但是不经常变动的页面，比如文章热门排行榜，这个调用数据库信息并且还要排序的完全可以使用缓存，因为不需要实时展现最新的<br>3、HTML 的片段，比如整个页面都经常变动，但是有个侧边栏不经常变动，就可以缓存侧边栏<br>4、需要使用复杂逻辑生成的 HTML 片段，使用缓存可以减少多次重复操作<br></p>
                                    
                                </div>

                                <div class="container">
                                    <button type="button" class="btn btn-primary" title="加微信与站长交流" data-container="body" data-toggle="popover" data-placement="top" data-content="站长微信：VIPdjango">
                                        联系站长
                                    </button>

                                </div>
                                <script>
                                    $(function () {
                                        $("[data-toggle='popover']").popover();
                                    });
                                </script>

                                <div class="article__footer">
                                    <div class="tags"><b>上一篇：</b>
                                        
                                            <a href="show-22.html" class="article-tag">Ubuntu部署Django项目方法详解</a>
                                        

                                    </div>
                                    <div class="tags"><b>下一篇：</b>
                                        
                                            <a href="show-30.html" class="article-tag">使用宝塔面板快速部署Django项目</a>
                                        
                                    </div>
                                </div>
                            </div>
                        </article>
                        <!--  广告位置 -->
                        <section id="comments">
                            <div class="comments__container">
                                <h3>文章评论 <span class="comment__count">0</span></h3>
                                
                                    <div class="comment__add">
                                        <div class="login-card">
                                            <a href="login1.html" class="btn btn-primary btn-login"><span>登录评论</span></a>
                                        </div>
                                    </div>
                                
                                </div>
                                
<div class="comments__list-wrapper">
<div id="comment__preview" style="display: none"></div>
<ul class="comments__list">
    
</ul>
</div>


                                <div class="comments--legacy"></div>
                        </section>
                    </div>
                    <aside class="col-md-3 hidden-sm hidden-xs">
                        <div class="article__author">
                            <div class="user">
                                <div class="profile__user-avatar" style="background-image: url('static/image/timg.jpg')"></div>
                                <div class="profile__info">
                                    <div class="profile__name">吴秀峰</div>
                                    <div class="badges"><span class="badge admin-badge" data-type="admin"></span></div>
                                    <!-- <div class="profile__karma" title="Karma: 113">113</div> -->
                                </div>
                                <div class="profile__description">
                                    <p>当你的才华和能力还不足以支撑你的野心的时候，静下心来，学习！</p>
                                </div>
                                <!--'data-hide=meta data-default=#default-links'-->
                                <ul class="profile__links" style="">
                                    <li class="profile__link-item change-github" data-change="github" style="display: none;" data-modify="href"><a href="#" target="_blank" rel="nofollow noreferrer noopener" title="Github URL"> <span class="link__icon link__icon--github"></span>
                                        <div class="change-github" data-change="github"></div>
                                    </a></li>
                                    <li class="profile__link-item change-twitter" data-change="twitter" style="display: none;" data-modify="href"><a href="#" target="_blank" rel="nofollow noreferrer noopener" title="Twitter URL"> <span class="link__icon link__icon--twitter"></span>
                                        <div class="change-twitter" data-change="twitter"></div>
                                    </a></li>
                                    <li class="profile__link-item change-website" data-change="website" style="display: none;" data-modify="href"><a href="#" target="_blank" rel="nofollow noreferrer noopener" title="Website URL"> <span class="link__icon link__icon--website"></span>
                                        <div class="change-website" data-change="website"></div>
                                    </a></li>
                                </ul>
                            </div>
                        </div>

                        <div class="row">
                            <div class="section sticky-content">
                                <div>
                                    <div class="sidebar-articles-group">
                                        <div class="group-title"><strong>最新文章</strong> <a href="article.html">更多</a></div>
                                        <ul class="list-group">
                                            
                                                <li>

                                                    <a href="show-39.html">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/12653.png')"></div>

                                                        </div>
                                                        <div class="list__right">
                                                            <h4>Django5.0正式发布，是你期待的吗？</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>

                                                    <a href="show-38.html">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/chatgpt.jpg')"></div>

                                                        </div>
                                                        <div class="list__right">
                                                            <h4>新手如何用Python玩转ChatGPT API,详细讲解</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>

                                                    <a href="show-37.html">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/drf.jpg')"></div>

                                                        </div>
                                                        <div class="list__right">
                                                            <h4>几个例子让新手快速了解Django REST Framework (DRF)</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>

                                                    <a href="show-36.html">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/python232323.jpg')"></div>

                                                        </div>
                                                        <div class="list__right">
                                                            <h4>提升效率,python的多线程详细使用方法</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>

                                                    <a href="show-35.html">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/djangoQ_Z4PNibz.jpg')"></div>

                                                        </div>
                                                        <div class="list__right">
                                                            <h4>Django-Q，轻量级消息队列Django-Q初体验</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>

                                                    <a href="show-34.html">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/Paginator.jpg')"></div>

                                                        </div>
                                                        <div class="list__right">
                                                            <h4>简单讲解Django分页Paginator和Page的用法</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>

                                                    <a href="show-33.html">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('https://www.django.cn/static/images/article_default.png')"></div>

                                                        </div>
                                                        <div class="list__right">
                                                            <h4>django4.0版本到底有哪些新功能和特性？</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>

                                                    <a href="show-32.html">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/bushu.jpg')"></div>

                                                        </div>
                                                        <div class="list__right">
                                                            <h4>Django+uWSGI+nginx部署原理及工作流程</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>

                                                    <a href="show-31.html">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/django-blog.jpg')"></div>

                                                        </div>
                                                        <div class="list__right">
                                                            <h4>Django入门视频教程之Blog开发详解</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>

                                                    <a href="show-30.html">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/bt_django.jpg')"></div>

                                                        </div>
                                                        <div class="list__right">
                                                            <h4>使用宝塔面板快速部署Django项目</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            

                                        </ul>
                                    </div>
                                    <div class="sidebar-articles-group">
                                        <div class="group-title"><strong>论坛新帖</strong> <a href="forum.html">更多</a></div>
                                        <ul class="list-group">
                                            
                                                <li>
                                                    <a href="forum-69779.html" class="list-group-item article-sidebar-link">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/default.gif')"></div>
                                                            <!-- <img src="picture/add-input-mask-200_3.png" alt="" /> -->
                                                        </div>
                                                        <div class="list__right">
                                                            <h4>123</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>
                                                    <a href="forum-69749.html" class="list-group-item article-sidebar-link">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/default.gif')"></div>
                                                            <!-- <img src="picture/add-input-mask-200_3.png" alt="" /> -->
                                                        </div>
                                                        <div class="list__right">
                                                            <h4>为什么每次只能导入一行数据呢？</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>
                                                    <a href="forum-69325.html" class="list-group-item article-sidebar-link">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/default.gif')"></div>
                                                            <!-- <img src="picture/add-input-mask-200_3.png" alt="" /> -->
                                                        </div>
                                                        <div class="list__right">
                                                            <h4>请教下django查询问题，开始时间2023-7-15 00:00:00 结束时间2023-7-20 23:59:59，查询统计出每天的数据总和，并输出这几天每天的总和</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>
                                                    <a href="forum-69324.html" class="list-group-item article-sidebar-link">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/default.gif')"></div>
                                                            <!-- <img src="picture/add-input-mask-200_3.png" alt="" /> -->
                                                        </div>
                                                        <div class="list__right">
                                                            <h4>请教：Invalid block tag on line 51: &#x27;empty&#x27;. Did you forget to register or load this tag?</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>
                                                    <a href="forum-69323.html" class="list-group-item article-sidebar-link">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/default.gif')"></div>
                                                            <!-- <img src="picture/add-input-mask-200_3.png" alt="" /> -->
                                                        </div>
                                                        <div class="list__right">
                                                            <h4>Django如何实现视图函数被调用之后异步回调</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>
                                                    <a href="forum-68919.html" class="list-group-item article-sidebar-link">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/default.gif')"></div>
                                                            <!-- <img src="picture/add-input-mask-200_3.png" alt="" /> -->
                                                        </div>
                                                        <div class="list__right">
                                                            <h4>我在用Django过程中碰到一个棘手的问题，关于SESSION_COOKIE_AGE</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>
                                                    <a href="forum-68918.html" class="list-group-item article-sidebar-link">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/avatar_-_副本.jpg')"></div>
                                                            <!-- <img src="picture/add-input-mask-200_3.png" alt="" /> -->
                                                        </div>
                                                        <div class="list__right">
                                                            <h4>求教Python小版本更新升级</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>
                                                    <a href="forum-68846.html" class="list-group-item article-sidebar-link">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/default.gif')"></div>
                                                            <!-- <img src="picture/add-input-mask-200_3.png" alt="" /> -->
                                                        </div>
                                                        <div class="list__right">
                                                            <h4>在pycharm中运行Django如何解决呢？</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>
                                                    <a href="forum-68845.html" class="list-group-item article-sidebar-link">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/default.gif')"></div>
                                                            <!-- <img src="picture/add-input-mask-200_3.png" alt="" /> -->
                                                        </div>
                                                        <div class="list__right">
                                                            <h4>项目启动失败</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            
                                                <li>
                                                    <a href="forum-68844.html" class="list-group-item article-sidebar-link">
                                                        <div class="list__left image-wrapper">
                                                            <div class="article__image" style="background-image: url('static/image/default.gif')"></div>
                                                            <!-- <img src="picture/add-input-mask-200_3.png" alt="" /> -->
                                                        </div>
                                                        <div class="list__right">
                                                            <h4>json解析错误</h4>
                                                        </div>
                                                    </a>
                                                </li>
                                            

                                        </ul>
                                    </div>
                                </div>
                            <div class="sidebar-articles-group sidebar-videos">
                                    <div class="group-title">
                                        <strong>视频教程</strong>
                                        <a class="subscribe-link" target="_blank" href="video.html">更多</a>
                                    </div>
                                    <ul class="sidebar-video-thumbnails">
                                        
                                        <li>
                                            <a target="_blank" href="video-3.html">
                                                <img class="video-thumb" src="static/picture/api.jpg">
                                            </a>
                                            <a target="_blank" href="video-3.html">
                                                <h4 class="video-title">Django+DRF+Vue打造专业的API自动化测试平台</h4>
                                            </a>
                                        </li>
                                        
                                        <li>
                                            <a target="_blank" href="video-2.html">
                                                <img class="video-thumb" src="static/picture/djangovue_H3w7CBm.jpg">
                                            </a>
                                            <a target="_blank" href="video-2.html">
                                                <h4 class="video-title">django+vue前后端分离仿美团外卖电商项目</h4>
                                            </a>
                                        </li>
                                        
                                        <li>
                                            <a target="_blank" href="video-1.html">
                                                <img class="video-thumb" src="static/picture/qiyekaifa.jpg">
                                            </a>
                                            <a target="_blank" href="video-1.html">
                                                <h4 class="video-title">django企业项目开发实战案例视频教程</h4>
                                            </a>
                                        </li>
                                        

                                    </ul>

                                </div>
                            </div>
                        </div>
                    </aside>
                </div>
            </div>
        </div>
    </main>

    
    <footer>
	 <h3>加入Django中文交流社区，分享交流，携手同行</h3>

	  <ul class="list-inline">
				<li><a href="index.html" class="neon">首 页</a></li>
				<li><a href="article.html" class="neon">文 章</a></li>
                <li><a href="course.html" class="neon">教 程</a></li>
                <li><a href="video.html" class="neon">视 频</a></li>
				<li><a href="forum.html" class="neon">社 区</a></li>
				<li><a href="about.html" class="neon">关于我们</a></li>
				<li><a href="contact.html" class="neon">联系我们</a></li>

	  </ul>

		<p class="copyright">Copyright © 2018 <a href="index1.html" target="_blank">django.cn</a>
			<span class="second-line">All Rights Reserved.</span><br>
            Powered by <a href="index.html">Django3</a><br>
           <a href="https://beian.miit.gov.cn" target="_blank">备案号：湘ICP备17023990号-1</a>
		</p>
</footer>

</div>

    <!-- JavaScripts -->

    <script type="text/javascript">

  $('#confirm-delete').on('show.bs.modal', function (event) {
  var button = $(event.relatedTarget) // Button that triggered the modal
  // var recipient = button.data('whatever') // Extract info from data-* attributes
  // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
  // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
  var aid = button.data('aid')
  var id = button.data('id')
  var tag = button.data('tag')
  var modal = $(this)
  // modal.find('.modal-title').text('New message to ' + recipient)
  modal.find('input[name="aid"]').val(aid)
  modal.find('input[name="id"]').val(id)
  modal.find('input[name="tag"]').val(tag)

  // console.log('ok')
})

  // btn_delete_comment
  $('#btn_delete_comment').click(function(event){
    // var form = new FormData(document.getElementById("delete_comment"))
    // var pwd1 = $('#change-pwd [name="password1"]').val()
    console.log('in comment delete')
    var aid = $('#delete_comment [name="aid"]').val()
    var id = $('#delete_comment [name="id"]').val()
    var tag = $('#delete_comment [name="tag"]').val()
    var token = $('#delete_comment [name="csrfmiddlewaretoken"]').val()
    if(!tag){
        return
    }

    var form = new FormData();
    form.append("id", 'id');
    form.append("csrfmiddlewaretoken", token);
    form.append('method','delete')

        $.ajax({
            type: 'POST',
            url: '/comment/'+id+'/',
            // data:'json',
            processData: false,
            contentType: false,
            data: form,
            success: function(response) {
                if(tag == 'forum'){
                    window.location.href = '/forum/forum-'+aid+'.html';
                }
                if(tag == 'article'){
                    window.location.href = '/article/show-'+aid+'.html';
                }
                if(tag == 'course'){
                    window.location.href = '/course/show-'+aid+'.html';
                }
            }
        })
  })
</script>
 <script src="static/js/bundle.js"></script>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
</body>
</html>
